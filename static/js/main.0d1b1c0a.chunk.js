(this["webpackJsonpsong-visualizations"]=this["webpackJsonpsong-visualizations"]||[]).push([[0],{123:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(7),r=function e(t){var n,r;Object(a.a)(this,e),this.genreToggles=void 0,this.yearStart=void 0,this.yearEnd=void 0,this.yearStart=null!==(n=t.yearStart)&&void 0!==n?n:1950,this.yearStart=this.yearStart>1950?this.yearStart:1950,this.yearEnd=null!==(r=t.yearStart)&&void 0!==r?r:2025,this.yearEnd=this.yearEnd<2025?this.yearEnd:2025,this.genreToggles=t.genreToggles}},283:function(e,t,n){},334:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),i=n(46),s=n.n(i),c=(n(283),n(9)),l=n(399),u=n(396),o=n(393),d=n(7),g=n(8),h=n.p+"static/media/spotify_decades.d5ba62b9.csv",f=function(){function e(t){for(var n in Object(d.a)(this,e),this.name="",this.artist="",this.album_name="",this.album_image_url="",this.album_release_date="",this.duration_ms="",this.explicit="",this.popularity="",this.preview_url="",this.danceability="",this.energy="",this.key="",this.loudness="",this.mode="",this.speechiness="",this.acousticness="",this.instrumentalness="",this.liveness="",this.valence="",this.tempo="",this.time_signature="",this.artist_followers="",this.artist_genres="",this.artist_popularity="",this.track_id="",t){var a;this[n]=null!==(a=t[n])&&void 0!==a?a:""}}return Object(g.a)(e,[{key:"year",value:function(){return Number(this.album_release_date.slice(0,4))}},{key:"decade",value:function(){return this.year()-this.year()%10}},{key:"genres",value:function(){return this.artist_genres.replaceAll(/[[\]'"]/gi,"").split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0}))}}]),e}();var b=n(61),j=n(39),y=["danceability","energy","speechiness","acousticness","instrumentalness","liveness","valence"],m=function(){function e(t){var n=this;Object(d.a)(this,e),this.rows=void 0,this.genres=void 0,this.genreCounts=void 0,this.rows=t;var a=t.flatMap((function(e){return e.genres()}));this.genreCounts=a.reduce((function(e,t){var n;return e.set(t,1+(null!==(n=e.get(t))&&void 0!==n?n:0))}),new Map),this.genres=Object(j.uniq)(a).sort((function(e,t){var a,r,i=null!==(a=n.genreCounts.get(e))&&void 0!==a?a:0,s=null!==(r=n.genreCounts.get(t))&&void 0!==r?r:0;return i===s?e.localeCompare(t):i-s}))}return Object(g.a)(e,[{key:"toUniqueArtistsRollup",value:function(e){var t=e.genreToggles.selectedGenres(),n=this.rows.filter((function(t){return t.year()>=e.yearStart})).filter((function(t){return t.year()<=e.yearEnd})).filter((function(e){return Object(j.isEmpty)(t)||Object(j.intersection)(t,e.genres()).length>0})).filter((function(e){return e.decade()>0})).map((function(e){return{artist:e.artist,year:e.year(),decade:e.decade(),genres:e.genres()}})),a=b.d(n,(function(e){return e.decade}),(function(e){return e.artist}));return Array.from(a).flatMap((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1],r=Array.from(a).map((function(e){var t=Object(c.a)(e,2),a=t[0],r=t[1];return{decade:n,artist:a,count:r.length,distinctArtists:1,genres:r.flatMap((function(e){return e.genres}))}}));return r.push({decade:n,artist:"",count:r.reduce((function(e,t){return e+t.count}),0),distinctArtists:r.length,genres:r.flatMap((function(e){return e.genres}))}),r}))}},{key:"toGenreVisRow",value:function(e){var t=e.genreToggles.selectedGenres();return this.rows.filter((function(t){return t.year()>=e.yearStart})).filter((function(t){return t.year()<=e.yearEnd})).filter((function(e){return Object(j.isEmpty)(t)||Object(j.intersection)(t,e.genres()).length>0})).flatMap((function(e){return y.map((function(t){return{year:e.year(),decade:e.decade(),feature_name:t,value:e[t]?Number(e[t]):0,genres:e.genres()}}))}))}}],[{key:"fromBlob",value:function(t){return new e(b.b(t).map((function(e){return new f(e)})))}}]),e}(),v=n(10),p=n(11),O=n(47),x=n(397),k=n(394),w=n(6),T=function(e){Object(v.a)(n,e);var t=Object(p.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"selected",value:function(e){var t;return null!==(t=this.get(e))&&void 0!==t&&t}},{key:"selectedGenres",value:function(){var e=this;return Array.from(this.keys()).filter((function(t){return e.selected(t)}))}}]),n}(Object(O.a)(Map));function S(e){function t(t){return Object(w.jsx)(o.a,{value:e.genreToggles.get(t),onChange:function(n){var a=new T(e.genreToggles);a.set(t,n.target.checked),e.setGenreToggles(a)}})}return Object(w.jsx)(x.a,{children:e.options.map((function(e){return Object(w.jsx)(k.a,{control:t(e),label:e},e)}))})}var _=n(40),A=n(398),C=n(391),E=n(123);function z(e){return{$schema:"https://vega.github.io/schema/vega/v5.json",description:"A radar chart example, showing multiple dimensions in a radial layout.",width:e.width,height:e.height,padding:e.padding,autosize:{type:"none",contains:"padding"},signals:[{name:"radius",update:"width / 2"}],data:[{name:"table",values:e.data},{name:"keys",source:"table",transform:[{type:"aggregate",groupby:["key"]}]}],scales:[{name:"angular",type:"point",range:{signal:"[-PI,PI]"},padding:.5,domain:{data:"table",field:"key"}},{name:"radial",type:"linear",range:{signal:"[0, radius]"},zero:!0,nice:!1,domain:{data:"table",field:"value"},domainMin:0},{name:"color",type:"ordinal",domain:{data:"table",field:"category"},range:{scheme:"category10"}}],encode:{enter:{x:{signal:"radius"},y:{signal:"radius"}}},marks:[{type:"group",name:"categories",zindex:1,from:{facet:{data:"table",name:"facet",groupby:["category"]}},marks:[{type:"line",name:"category-line",from:{data:"facet"},encode:{enter:{interpolate:{value:"linear-closed"},x:{signal:"scale('radial', datum.value) * cos(scale('angular', datum.key))"},y:{signal:"scale('radial', datum.value) * sin(scale('angular', datum.key))"},stroke:{scale:"color",field:"category"},strokeWidth:{value:1},fill:{scale:"color",field:"category"},fillOpacity:{value:.1}}}},{type:"text",name:"value-text",from:{data:"category-line"},encode:{enter:{x:{signal:"datum.x"},y:{signal:"datum.y"},text:{signal:"datum.datum.value"},align:{value:"center"},baseline:{value:"middle"},fill:{value:"black"}}}}]},{type:"rule",name:"radial-grid",from:{data:"keys"},zindex:0,encode:{enter:{x:{value:0},y:{value:0},x2:{signal:"radius * cos(scale('angular', datum.key))"},y2:{signal:"radius * sin(scale('angular', datum.key))"},stroke:{value:"lightgray"},strokeWidth:{value:1}}}},{type:"text",name:"key-label",from:{data:"keys"},zindex:1,encode:{enter:{x:{signal:"(radius + 5) * cos(scale('angular', datum.key))"},y:{signal:"(radius + 5) * sin(scale('angular', datum.key))"},text:{field:"key"},align:[{test:"abs(scale('angular', datum.key)) > PI / 2",value:"right"},{value:"left"}],baseline:[{test:"scale('angular', datum.key) > 0",value:"top"},{test:"scale('angular', datum.key) == 0",value:"middle"},{value:"bottom"}],fill:{value:"black"},fontWeight:{value:"bold"}}}},{type:"line",name:"outer-line",from:{data:"radial-grid"},encode:{enter:{interpolate:{value:"linear-closed"},x:{field:"x2"},y:{field:"y2"},stroke:{value:"lightgray"},strokeWidth:{value:1}}}}]}}function G(e){if(!e.show)return Object(w.jsx)(A.a,{});var t=new E.a(e),n=e.dataset.toGenreVisRow(t).map((function(e){return{key:e.feature_name,category:e.decade,value:e.value}})),a=b.c(n,(function(e){return e.category}),(function(e){return e.key})).map((function(e){var t=Object(c.a)(e,3);return{category:t[0],key:t[1],value:t[2].reduce((function(e,t){return e+t.value}),0)}})),r=Object(j.uniq)(a.map((function(e){return e.category}))).sort();return Object(w.jsx)(A.a,{children:Object(w.jsx)(u.a,{container:!0,children:r.map((function(t){return Object(w.jsxs)(u.a,{item:!0,md:6,children:[Object(w.jsx)("h3",{children:t}),Object(w.jsx)(C.a,{spec:z(Object(_.a)(Object(_.a)({},e),{},{data:a.filter((function(e){return t===e.category}))}))})]},t)}))})})}var M=n(5),I=n(392);function B(e){var t=Object(a.useState)(""),n=Object(c.a)(t,2),r=n[0],i=n[1],s=e.options.filter((function(e){return e&&e.toLowerCase().includes(r)})).slice(0,10),l=Object(j.uniq)([].concat(Object(M.a)(s),Object(M.a)(e.selected)));return Object(w.jsxs)(u.a,{container:!0,children:[Object(w.jsx)(u.a,{item:!0,xs:12,children:Object(w.jsx)(I.a,{label:"search genres",variant:"standard",onChange:function(e){return i(e.target.value)}})}),Object(w.jsxs)(u.a,{item:!0,xs:12,children:[Object(w.jsx)("h4",{children:"Top matches"}),Object(w.jsx)(S,{genreToggles:e.genreToggles,setGenreToggles:e.setGenreToggles,options:l})]})]})}var q=Object(a.lazy)((function(){return n.e(3).then(n.bind(null,402))})),R=Object(a.lazy)((function(){return n.e(5).then(n.bind(null,400))})),V=Object(a.lazy)((function(){return n.e(4).then(n.bind(null,401))})),W=Object(w.jsx)("p",{children:"Loading..."});var F=function(){var e=function(){var e=Object(a.useState)(sessionStorage.getItem("dataBytes")),t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){var e;(null!==(e=null===n||void 0===n?void 0:n.length)&&void 0!==e?e:0)>0||fetch(h).then((function(e){return e.text()})).then((function(e){e&&(r(e),sessionStorage.setItem("dataBytes",e))}))})),n}(),t=Object(a.useState)(new T),n=Object(c.a)(t,2),r=n[0],i=n[1],s=Object(a.useState)(!0),d=Object(c.a)(s,2),g=d[0],f=d[1],b=Object(a.useState)(!1),j=Object(c.a)(b,2),y=j[0],v=j[1],p=Object(a.useState)(!1),O=Object(c.a)(p,2),x=O[0],k=O[1],S=Object(a.useState)(!1),_=Object(c.a)(S,2),A=_[0],C=_[1];if(!e)return W;var E=m.fromBlob(e),z=E.genres.reverse(),M=Array.from(r.keys()).filter((function(e){return r.get(e)}));return Object(w.jsx)(a.Suspense,{fallback:W,children:Object(w.jsx)(l.a,{children:Object(w.jsxs)(u.a,{container:!0,children:[Object(w.jsx)(u.a,{item:!0,xs:12,children:Object(w.jsx)("h1",{style:{textAlign:"center"},children:"Audio Features"})}),Object(w.jsx)(u.a,{item:!0,xs:2,children:Object(w.jsx)(B,{genreToggles:r,setGenreToggles:i,options:z,selected:M})}),Object(w.jsxs)(u.a,{item:!0,xs:10,children:[Object(w.jsx)("h2",{children:"Variation in Features"}),Object(w.jsx)(o.a,{checked:g,onChange:function(e){f(e.target.checked)}}),Object(w.jsx)(q,{show:g,dataset:E,genreToggles:r,height:300,width:800}),Object(w.jsx)("h2",{children:"Variation in Features Radar"}),Object(w.jsx)(o.a,{checked:y,onChange:function(e){v(e.target.checked)}}),Object(w.jsx)(G,{show:y,dataset:E,genreToggles:r,height:400,width:400,padding:40}),Object(w.jsx)("h2",{children:"Count of Top Artists"}),Object(w.jsx)(o.a,{checked:x,onChange:function(e){k(e.target.checked)}}),Object(w.jsx)(R,{show:x,dataset:E,genreToggles:r,height:300,width:800,margin:{left:50,top:50,right:20,bottom:20}}),Object(w.jsx)("h2",{children:"Top Artists by Decade"}),Object(w.jsx)(o.a,{checked:A,onChange:function(e){C(e.target.checked)}}),Object(w.jsx)(V,{show:A,dataset:E,genreToggles:r,topN:10,height:300,width:800})]})]})})})};s.a.render(Object(w.jsx)(r.a.StrictMode,{children:Object(w.jsx)(F,{})}),document.getElementById("root"))}},[[334,1,2]]]);
//# sourceMappingURL=main.0d1b1c0a.chunk.js.map