(this["webpackJsonpsong-visualizations"]=this["webpackJsonpsong-visualizations"]||[]).push([[0],{288:function(e,t,a){},339:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),i=a(48),s=a.n(i),c=(a(288),a(9)),o=a(408),u=a(404),l=a(401),d=a(395),h=a(406),g=a(400),f=a(6),j=a(24),b=a(405),m=a(36),v=a(35),p=a(397);function y(e){return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",mark:{type:"bar",tooltip:!0},data:{values:e.data},width:e.width,height:e.height,encoding:{x:{field:"count",type:"quantitative",axis:{title:"Number of Top Hits"}},y:{field:"artist",type:"nominal",axis:{title:""},sort:"-x"},color:{field:"artist",type:"nominal",sort:"-x"}}}}function O(e){var t,a,n,r=null!==(t=e.radius)&&void 0!==t?t:120,i=null!==(a=e.innerRadius)&&void 0!==a?a:60,s=(r-i)/2+i;return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",layer:[{mark:{type:"arc",tooltip:!0,radius:r,innerRadius:i,padAngle:null!==(n=e.innerRadius)&&void 0!==n?n:.01},encoding:{theta:{type:"quantitative",field:"count",stack:!0},color:{field:"artist",type:"nominal"}}},{mark:{type:"text",radius:s},encoding:{theta:{type:"quantitative",field:"count",stack:!0},text:{type:"nominal",field:"artist"}}}],data:{values:e.data},width:e.width,height:e.height}}var x=a(5);function k(e){if(!e.show)return Object(x.jsx)(b.a,{});var t=e.dataset.toArtistsVisRow(e.filter).filter((function(e){return""!==e.artist})),a=m.d(t,(function(e){return e.decade})),n=function(e,t){return{decade:e,distinctArtists:0,artist:t,genres:[],count:0}},r=function(e,t){return Object(j.a)(Object(j.a)({},e),{},{count:e.count+t.count,distinctArtists:e.distinctArtists+t.distinctArtists,genres:Object(v.uniq)([].concat(Object(f.a)(e.genres),Object(f.a)(t.genres)))})},i=[],s=[];Array.from(a.entries()).forEach((function(t){var a=Object(c.a)(t,2),o=a[0],u=a[1].sort((function(e,t){return e.count-t.count})).reverse(),l=u.slice(0,e.topN),d=l.reduce(r,n(o,"Top ".concat(e.topN))),h=u.slice(e.topN,-1).reduce(r,n(o,"Others"));i.push(h),i.push(d),s.push.apply(s,Object(f.a)(l))}));var o=Object(v.uniq)(s.map((function(e){return e.decade}))).sort();return Object(x.jsx)(b.a,{children:o.map((function(t){return Object(x.jsxs)(u.a,{container:!0,children:[Object(x.jsx)(u.a,{item:!0,xs:12,children:Object(x.jsxs)("h3",{children:[t," - ",t+10]})}),Object(x.jsxs)(u.a,{item:!0,md:6,children:[Object(x.jsxs)("h4",{children:["How many tops hits were produced by the top ",e.topN," artists?"]}),Object(x.jsx)(p.a,{width:350,spec:O(Object(j.a)(Object(j.a)({},e),{},{data:i.filter((function(e){return e.decade===t}))}))})]}),Object(x.jsx)(u.a,{item:!0,md:6,children:Object(x.jsx)(p.a,{width:350,spec:y(Object(j.a)(Object(j.a)({},e),{},{data:s.filter((function(e){return e.decade===t}))}))})})]},t)}))})}function w(e){if(!e.show)return Object(x.jsx)(b.a,{});var t=e.dataset.toArtistsVisRow(e.filter).filter((function(e){return e.distinctArtists>1}));return t.sort((function(e,t){return e.decade-t.decade})),Object(x.jsx)(b.a,{children:Object(x.jsx)(A,{rollupData:t,height:e.height,width:e.width,margin:e.margin})})}function A(e){var t=Object(n.useRef)(null);return Object(n.useEffect)((function(){var a=function(e){var t=e.width-e.margin.left-e.margin.right,a=e.height-e.margin.top-e.margin.bottom,n=e.rollupData,r="distinctArtists",i=m.f([0,t]).domain(Array.from(new Array(8).keys()).map((function(e){return 1950+10*e})).map((function(e){return e.toString()}))).padding(.05),s=m.g([a,0]).domain([0,210]),c=m.e().x((function(e){var t;return(null!==(t=i(e.decade.toString()))&&void 0!==t?t:0)+i.bandwidth()/2})).y((function(e){return s(e.distinctArtists)})),o=m.h(e.ref.current).append("svg").attr("viewBox","0 0 ".concat(e.width," ").concat(e.height)),u=o.append("g").attr("transform","translate(".concat(e.margin.left,", ").concat(e.margin.top,")"));return u.selectAll("rect").data(n).join("rect").attr("x",(function(e){var t;return null!==(t=i(e.decade.toString()))&&void 0!==t?t:0})).attr("width",(function(){return i.bandwidth()})).attr("y",(function(e){return s(e[r])})).attr("height",(function(e){return a-s(e[r])})).attr("fill","#adc2eb"),u.selectAll(".point").data(n).join("circle").attr("class","point").attr("cx",(function(e){var t;return(null!==(t=i(e.decade.toString()))&&void 0!==t?t:0)+i.bandwidth()/2})).attr("cy",(function(e){return s(e[r])})).attr("r",2).attr("fill","black"),u.append("path").datum(n).attr("d",(function(e){return c(e)})).attr("fill","none").attr("class","line").attr("stroke","steelblue").attr("stroke-width",1.5),u.selectAll(".countText").data(n).join("text").text((function(e){return e.distinctArtists})).attr("class","countText").attr("text-anchor","middle").attr("x",(function(e){var t;return(null!==(t=i(e.decade.toString()))&&void 0!==t?t:0)+i.bandwidth()/2})).attr("y",(function(e){return s(e[r])-15})),u.append("g").attr("transform","translate(0, ".concat(a,")")).style("font-size","small").call(m.a(i)),o}(Object(j.a)({ref:t},e));return function(){a.remove()}})),Object(x.jsx)("div",{ref:t})}function S(e){var t=Object(v.uniq)(e.data.map((function(e){return e.decade}))).sort();return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",mark:{type:"area"},width:e.width,height:e.height,data:{values:e.data},encoding:{x:{field:"year",type:"quantitative",title:"Year",axis:{format:"d",values:Object(v.uniq)(t)},scale:{domain:[e.yearStart,e.yearEnd]}},y:{aggregate:"sum",field:"value",title:"Feature Dominance",stack:"normalize"},color:{field:"feature_name",type:"nominal",title:"Audio Feature"}}}}function T(e){return e.show?Object(x.jsx)(b.a,{children:Object(x.jsx)(p.a,{spec:S(Object(j.a)(Object(j.a)(Object(j.a)({},e),e.filter),{},{data:e.dataset.unpivotFeatures(e.filter)}))})}):Object(x.jsx)(b.a,{})}function _(e){return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",data:{values:e.data},width:e.width,height:e.height,mark:{type:"bar",tooltip:!0},encoding:{x:{type:"quantitative",field:"value"},y:{type:"nominal",field:"featureName"},color:{type:"nominal",field:"featureName"}}}}function C(e){var t=e.dataset.unpivotFeatures(e.filter),a=function(e){return e.map((function(e){return e.value})).reduce((function(e,t){return e+t}))/e.length},n=m.c(t,(function(e){return e.feature_name})).map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return{featureName:n,value:a(r)}}));return e.hidden?Object(x.jsx)("div",{}):Object(x.jsx)(b.a,{children:Object(x.jsx)(p.a,{spec:_(Object(j.a)(Object(j.a)({},e),{},{data:n}))})})}function E(e){return{$schema:"https://vega.github.io/schema/vega/v5.json",description:"A radar chart example, showing multiple dimensions in a radial layout.",width:e.width,height:e.height,padding:e.padding,autosize:{type:"none",contains:"padding"},signals:[{name:"radius",update:"width / 2"}],data:[{name:"table",values:e.data},{name:"keys",source:"table",transform:[{type:"aggregate",groupby:["key"]}]}],scales:[{name:"angular",type:"point",range:{signal:"[-PI,PI]"},padding:.5,domain:{data:"table",field:"key"}},{name:"radial",type:"linear",range:{signal:"[0, radius]"},zero:!0,nice:!1,domain:{data:"table",field:"value"},domainMin:0},{name:"color",type:"ordinal",domain:{data:"table",field:"category"},range:{scheme:"category10"}}],encode:{enter:{x:{signal:"radius"},y:{signal:"radius"}}},marks:[{type:"group",name:"categories",zindex:1,from:{facet:{data:"table",name:"facet",groupby:["category"]}},marks:[{type:"line",name:"category-line",from:{data:"facet"},encode:{enter:{interpolate:{value:"linear-closed"},x:{signal:"scale('radial', datum.value) * cos(scale('angular', datum.key))"},y:{signal:"scale('radial', datum.value) * sin(scale('angular', datum.key))"},stroke:{scale:"color",field:"category"},strokeWidth:{value:1},fill:{scale:"color",field:"category"},fillOpacity:{value:.1}}}},{type:"text",name:"value-text",from:{data:"category-line"},encode:{enter:{x:{signal:"datum.x"},y:{signal:"datum.y"},text:{signal:"datum.datum.value"},align:{value:"center"},baseline:{value:"middle"},fill:{value:"black"}}}}]},{type:"rule",name:"radial-grid",from:{data:"keys"},zindex:0,encode:{enter:{x:{value:0},y:{value:0},x2:{signal:"radius * cos(scale('angular', datum.key))"},y2:{signal:"radius * sin(scale('angular', datum.key))"},stroke:{value:"lightgray"},strokeWidth:{value:1}}}},{type:"text",name:"key-label",from:{data:"keys"},zindex:1,encode:{enter:{x:{signal:"(radius + 5) * cos(scale('angular', datum.key))"},y:{signal:"(radius + 5) * sin(scale('angular', datum.key))"},text:{field:"key"},align:[{test:"abs(scale('angular', datum.key)) > PI / 2",value:"right"},{value:"left"}],baseline:[{test:"scale('angular', datum.key) > 0",value:"top"},{test:"scale('angular', datum.key) == 0",value:"middle"},{value:"bottom"}],fill:{value:"black"},fontWeight:{value:"bold"}}}},{type:"line",name:"outer-line",from:{data:"radial-grid"},encode:{enter:{interpolate:{value:"linear-closed"},x:{field:"x2"},y:{field:"y2"},stroke:{value:"lightgray"},strokeWidth:{value:1}}}}]}}function q(e){if(!e.show)return Object(x.jsx)(b.a,{});var t=e.dataset.unpivotFeatures(e.filter).map((function(e){return{key:e.feature_name,category:e.decade,value:e.value}})),a=m.c(t,(function(e){return e.category}),(function(e){return e.key})).map((function(e){var t=Object(c.a)(e,3);return{category:t[0],key:t[1],value:t[2].reduce((function(e,t){return e+t.value}),0)}})),n=Object(v.uniq)(a.map((function(e){return e.category}))).sort();return Object(x.jsx)(b.a,{children:Object(x.jsx)(u.a,{container:!0,children:n.map((function(t){return Object(x.jsxs)(u.a,{item:!0,md:6,children:[Object(x.jsx)("h3",{children:t}),Object(x.jsx)(p.a,{spec:E(Object(j.a)(Object(j.a)({},e),{},{data:a.filter((function(e){return t===e.category}))}))})]},t)}))})})}var z=a(402),F=a(7),M=a(8),N=a.p+"static/media/spotify_decades.d5ba62b9.csv",R=function(){function e(t){for(var a in Object(F.a)(this,e),this.name="",this.artist="",this.album_name="",this.album_image_url="",this.album_release_date="",this.duration_ms="",this.explicit="",this.popularity="",this.preview_url="",this.danceability="",this.energy="",this.key="",this.loudness="",this.mode="",this.speechiness="",this.acousticness="",this.instrumentalness="",this.liveness="",this.valence="",this.tempo="",this.time_signature="",this.artist_followers="",this.artist_genres="",this.artist_popularity="",this.track_id="",t){var n;this[a]=null!==(n=t[a])&&void 0!==n?n:""}}return Object(M.a)(e,[{key:"year",value:function(){return Number(this.album_release_date.slice(0,4))}},{key:"decade",value:function(){return this.year()-this.year()%10}},{key:"genres",value:function(){return this.artist_genres.replaceAll(/[[\]'"]/gi,"").split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0}))}}]),e}();var V=["danceability","energy","speechiness","acousticness","instrumentalness","liveness","valence"],I=function(){function e(t){var a=this;Object(F.a)(this,e),this.rows=void 0,this.genres=void 0,this.genreCounts=void 0,this.rows=t;var n=t.flatMap((function(e){return e.genres()}));this.genreCounts=n.reduce((function(e,t){var a;return e.set(t,1+(null!==(a=e.get(t))&&void 0!==a?a:0))}),new Map),this.genres=Object(v.uniq)(n).sort((function(e,t){var n,r,i=null!==(n=a.genreCounts.get(e))&&void 0!==n?n:0,s=null!==(r=a.genreCounts.get(t))&&void 0!==r?r:0;return i===s?e.localeCompare(t):i-s}))}return Object(M.a)(e,[{key:"selectCSVRows",value:function(e){var t=e.genreToggles.selection();return this.rows.filter((function(t){return t.year()>=e.yearStart})).filter((function(t){return t.year()<=e.yearEnd})).filter((function(e){return Object(v.isEmpty)(t)||Object(v.intersection)(t,e.genres()).length>0}))}},{key:"unpivotFeatures",value:function(e){var t=e.featureToggles.selection();return Object(v.isEmpty)(t)&&t.push.apply(t,V),this.selectCSVRows(e).flatMap((function(e){return t.map((function(t){return{year:e.year(),decade:e.decade(),feature_name:t,value:e[t]?Number(e[t]):0,genres:e.genres()}}))}))}},{key:"toArtistsVisRow",value:function(e){var t=this.selectCSVRows(e).map((function(e){return{artist:e.artist,year:e.year(),decade:e.decade(),genres:e.genres()}})),a=m.d(t,(function(e){return e.decade}),(function(e){return e.artist}));return Array.from(a).flatMap((function(e){var t=Object(c.a)(e,2),a=t[0],n=t[1],r=Array.from(n).map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return{decade:a,artist:n,count:r.length,distinctArtists:1,genres:r.flatMap((function(e){return e.genres}))}}));return r.push({decade:a,artist:"",count:r.reduce((function(e,t){return e+t.count}),0),distinctArtists:r.length,genres:r.flatMap((function(e){return e.genres}))}),r}))}}],[{key:"fromBlob",value:function(t){return new e(m.b(t).map((function(e){return new R(e)})))}}]),e}(),B=a(10),D=a(11),$=a(50),P=function(e){Object(B.a)(a,e);var t=Object(D.a)(a);function a(){return Object(F.a)(this,a),t.apply(this,arguments)}return Object(M.a)(a,[{key:"selected",value:function(e){var t;return null!==(t=this.get(e))&&void 0!==t&&t}},{key:"selection",value:function(){var e=this;return Array.from(this.keys()).filter((function(t){return e.selected(t)}))}}]),a}(Object($.a)(Map));function W(e){return Object(x.jsx)(l.a,{value:e.toggles.get(e.name),onChange:function(t){var a=new P(e.toggles);a.set(e.name,t.target.checked),e.setToggles(a)}})}function J(e){return e.hidden?Object(x.jsx)("div",{}):Object(x.jsxs)(b.a,{children:["Toggle Features",Object(x.jsx)(d.a,{direction:"row",children:V.map((function(t){return Object(x.jsx)(z.a,{control:W(Object(j.a)(Object(j.a)({},e),{},{name:t})),label:t},t)}))})]})}var H=a(398),L=a(407);function K(e){var t=Object(n.useState)(""),a=Object(c.a)(t,2),r=a[0],i=a[1],s=e.options.filter((function(e){return e&&e.toLowerCase().includes(r)})).slice(0,10),o=Object(v.uniq)([].concat(Object(f.a)(s),Object(f.a)(e.toggles.selection())));return Object(x.jsxs)(u.a,{container:!0,children:[Object(x.jsx)(u.a,{item:!0,xs:12,children:Object(x.jsx)(H.a,{label:"search genres",variant:"standard",onChange:function(e){return i(e.target.value)}})}),Object(x.jsxs)(u.a,{item:!0,xs:12,children:[Object(x.jsx)("h4",{children:"Top matches"}),Object(x.jsx)(L.a,{children:o.map((function(t){return Object(x.jsx)(z.a,{control:W(Object(j.a)(Object(j.a)({},e),{},{name:t})),label:t},t)}))})]})]})}var Y=1950,G=2019,Q=function e(t){var a,n;Object(F.a)(this,e),this.genreToggles=void 0,this.featureToggles=void 0,this.yearStart=void 0,this.yearEnd=void 0,this.yearStart=null!==(a=t.yearStart)&&void 0!==a?a:Y,this.yearStart=this.yearStart>Y?this.yearStart:Y,this.yearEnd=null!==(n=t.yearStart)&&void 0!==n?n:G,this.yearEnd=this.yearEnd<G?this.yearEnd:G,this.genreToggles=t.genreToggles,this.featureToggles=t.featureToggles},U=Object(x.jsx)("p",{children:"Loading..."});var X=function(){var e=function(){var e=Object(n.useState)(sessionStorage.getItem("dataBytes")),t=Object(c.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){var e;(null!==(e=null===a||void 0===a?void 0:a.length)&&void 0!==e?e:0)>0||fetch(N).then((function(e){return e.text()})).then((function(e){e&&(r(e),sessionStorage.setItem("dataBytes",e))}))})),a}(),t=Object(n.useState)(new P),a=Object(c.a)(t,2),r=a[0],i=a[1],s=Object(n.useState)(new P),f=Object(c.a)(s,2),j=f[0],b=f[1],m=Object(n.useState)(void 0),v=Object(c.a)(m,1)[0],p=Object(n.useState)(void 0),y=Object(c.a)(p,1)[0],O=Object(n.useState)(!0),A=Object(c.a)(O,2),S=A[0],_=A[1],E=Object(n.useState)(!1),z=Object(c.a)(E,2),F=z[0],M=z[1],R=Object(n.useState)(!1),V=Object(c.a)(R,2),B=V[0],D=V[1],$=Object(n.useState)(!1),W=Object(c.a)($,2),H=W[0],L=W[1];if(!e)return U;var Y=I.fromBlob(e),G=new Q({yearStart:v,yearEnd:y,featureToggles:j,genreToggles:r});return Object(x.jsx)(n.Suspense,{fallback:U,children:Object(x.jsx)(o.a,{children:Object(x.jsxs)(u.a,{container:!0,children:[Object(x.jsxs)(u.a,{item:!0,xs:12,style:{textAlign:"center"},children:[Object(x.jsx)("h1",{children:"Visualizing Audio Features over the Decades"}),Object(x.jsx)("em",{children:"Created by Jackson Argo, Matt Kinley, and Erick Martinez."})]}),Object(x.jsx)(u.a,{item:!0,xs:12,children:Object(x.jsx)(J,{hidden:!0,toggles:j,setToggles:b})}),Object(x.jsx)(u.a,{item:!0,xs:2,children:Object(x.jsx)(K,{toggles:r,setToggles:i,options:Y.genres.reverse()})}),Object(x.jsxs)(u.a,{item:!0,xs:10,children:[Object(x.jsx)(C,{hidden:!0,dataset:Y,filter:G,height:300,width:800}),Object(x.jsx)("h2",{children:"Variation in Features"}),Object(x.jsx)(l.a,{checked:S,onChange:function(e){_(e.target.checked)}}),Object(x.jsx)(T,{show:S,dataset:Y,filter:G,height:300,width:800}),Object(x.jsx)("h2",{children:"Variation in Features Radar"}),Object(x.jsx)(l.a,{checked:F,onChange:function(e){M(e.target.checked)}}),Object(x.jsx)(q,{show:F,dataset:Y,filter:G,height:400,width:400,padding:40}),Object(x.jsx)("h2",{children:"Count of Top Artists"}),Object(x.jsx)(l.a,{checked:B,onChange:function(e){D(e.target.checked)}}),Object(x.jsx)(w,{show:B,dataset:Y,filter:G,height:300,width:800,margin:{left:50,top:50,right:20,bottom:20}}),Object(x.jsx)("h2",{children:"Top Artists by Decade"}),Object(x.jsx)(l.a,{checked:H,onChange:function(e){L(e.target.checked)}}),Object(x.jsx)(k,{show:H,dataset:Y,filter:G,topN:10,height:300,width:800})]}),Object(x.jsx)(u.a,{item:!0,xs:12,children:Object(x.jsx)(u.a,{container:!0,justifyContent:"center",children:Object(x.jsx)(u.a,{item:!0,children:Object(x.jsx)(d.a,{spacing:{xs:3},children:Object(x.jsx)(h.a,{children:Object(x.jsx)(g.a,{children:Object(x.jsx)("a",{href:"https://developer.spotify.com/documentation/web-api/reference/#/operations/get-audio-features",children:"Spotify's Audio Features API Docs"})})})})})})})]})})})};s.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsx)(X,{})}),document.getElementById("root"))}},[[339,1,2]]]);
//# sourceMappingURL=main.e90c7c4b.chunk.js.map