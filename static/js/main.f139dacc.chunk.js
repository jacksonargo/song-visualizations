(this["webpackJsonpsong-visualizations"]=this["webpackJsonpsong-visualizations"]||[]).push([[0],{283:function(e,t,a){},334:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),i=a(47),s=a.n(i),c=(a(283),a(9)),o=a(398),u=a(395),l=a(392),d=a(5),h=a(28),g=a(396),f=a(36),j=a(33),b=a(390),m=a(7),y=function e(t){var a,n;Object(m.a)(this,e),this.genreToggles=void 0,this.yearStart=void 0,this.yearEnd=void 0,this.yearStart=null!==(a=t.yearStart)&&void 0!==a?a:1950,this.yearStart=this.yearStart>1950?this.yearStart:1950,this.yearEnd=null!==(n=t.yearStart)&&void 0!==n?n:2025,this.yearEnd=this.yearEnd<2025?this.yearEnd:2025,this.genreToggles=t.genreToggles};function v(e){return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",mark:{type:"bar",tooltip:!0},data:{values:e.data},width:e.width,height:e.height,encoding:{x:{field:"count",type:"quantitative",axis:{title:"Number of Top Hits"}},y:{field:"artist",type:"nominal"},color:{field:"artist",type:"nominal"}}}}function p(e){var t,a,n,r=null!==(t=e.radius)&&void 0!==t?t:120,i=null!==(a=e.innerRadius)&&void 0!==a?a:60,s=(r-i)/2+i;return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",layer:[{mark:{type:"arc",tooltip:!0,radius:r,innerRadius:i,padAngle:null!==(n=e.innerRadius)&&void 0!==n?n:.01},encoding:{theta:{type:"quantitative",field:"count",stack:!0},color:{field:"artist",type:"nominal"}}},{mark:{type:"text",radius:s},encoding:{theta:{type:"quantitative",field:"count",stack:!0},text:{type:"nominal",field:"artist"}}}],data:{values:e.data},width:e.width,height:e.height}}var O=a(6);function x(e){if(!e.show)return Object(O.jsx)(g.a,{});var t=e.dataset.toArtistsVisRow(new y(e)).filter((function(e){return""!==e.artist})),a=f.d(t,(function(e){return e.decade})),n=function(e,t){return{decade:e,distinctArtists:0,artist:t,genres:[],count:0}},r=function(e,t){return Object(h.a)(Object(h.a)({},e),{},{count:e.count+t.count,distinctArtists:e.distinctArtists+t.distinctArtists,genres:Object(j.uniq)([].concat(Object(d.a)(e.genres),Object(d.a)(t.genres)))})},i=[],s=[];Array.from(a.entries()).forEach((function(t){var a=Object(c.a)(t,2),o=a[0],u=a[1].sort((function(e,t){return e.count-t.count})).reverse(),l=u.slice(0,e.topN),h=l.reduce(r,n(o,"Top ".concat(e.topN,"\nArtists"))),g=u.slice(e.topN,-1).reduce(r,n(o,"Others"));i.push(g),i.push(h),s.push.apply(s,Object(d.a)(l))}));var o=Object(j.uniq)(s.map((function(e){return e.decade}))).sort();return Object(O.jsx)(g.a,{children:o.map((function(t){return Object(O.jsxs)(u.a,{container:!0,children:[Object(O.jsx)(u.a,{item:!0,xs:12,children:Object(O.jsx)("h3",{children:t})}),Object(O.jsxs)(u.a,{item:!0,md:6,children:[Object(O.jsxs)("h4",{children:["How many tops hits were produced by the top ",e.topN," artists?"]}),Object(O.jsx)(b.a,{width:350,spec:p(Object(h.a)(Object(h.a)({},e),{},{data:i.filter((function(e){return e.decade===t}))}))})]}),Object(O.jsx)(u.a,{item:!0,md:6,children:Object(O.jsx)(b.a,{width:350,spec:v(Object(h.a)(Object(h.a)({},e),{},{data:s.filter((function(e){return e.decade===t}))}))})})]},t)}))})}function k(e){if(!e.show)return Object(O.jsx)(g.a,{});var t=e.dataset.toArtistsVisRow(Object(h.a)(Object(h.a)({},e),new y(e))).filter((function(e){return e.distinctArtists>1}));return t.sort((function(e,t){return e.decade-t.decade})),Object(O.jsx)(g.a,{children:Object(O.jsx)(w,{rollupData:t,height:e.height,width:e.width,margin:e.margin})})}function w(e){var t=Object(n.useRef)(null);return Object(n.useEffect)((function(){var a=function(e){var t=e.width-e.margin.left-e.margin.right,a=e.height-e.margin.top-e.margin.bottom,n=e.rollupData,r="distinctArtists",i=f.f([0,t]).domain(Array.from(new Array(8).keys()).map((function(e){return 1950+10*e})).map((function(e){return e.toString()}))).padding(.05),s=f.g([a,0]).domain([0,210]),c=f.e().x((function(e){var t;return(null!==(t=i(e.decade.toString()))&&void 0!==t?t:0)+i.bandwidth()/2})).y((function(e){return s(e.distinctArtists)})),o=f.h(e.ref.current).append("svg").attr("viewBox","0 0 ".concat(e.width," ").concat(e.height)),u=o.append("g").attr("transform","translate(".concat(e.margin.left,", ").concat(e.margin.top,")"));return u.selectAll("rect").data(n).join("rect").attr("x",(function(e){var t;return null!==(t=i(e.decade.toString()))&&void 0!==t?t:0})).attr("width",(function(){return i.bandwidth()})).attr("y",(function(e){return s(e[r])})).attr("height",(function(e){return a-s(e[r])})).attr("fill","#adc2eb"),u.selectAll(".point").data(n).join("circle").attr("class","point").attr("cx",(function(e){var t;return(null!==(t=i(e.decade.toString()))&&void 0!==t?t:0)+i.bandwidth()/2})).attr("cy",(function(e){return s(e[r])})).attr("r",2).attr("fill","black"),u.append("path").datum(n).attr("d",(function(e){return c(e)})).attr("fill","none").attr("class","line").attr("stroke","steelblue").attr("stroke-width",1.5),u.selectAll(".countText").data(n).join("text").text((function(e){return e.distinctArtists})).attr("class","countText").attr("text-anchor","middle").attr("x",(function(e){var t;return(null!==(t=i(e.decade.toString()))&&void 0!==t?t:0)+i.bandwidth()/2})).attr("y",(function(e){return s(e[r])-15})),u.append("g").attr("transform","translate(0, ".concat(a,")")).style("font-size","small").call(f.a(i)),o}(Object(h.a)({ref:t},e));return function(){a.remove()}})),Object(O.jsx)("div",{ref:t})}function A(e){var t=Object(j.uniq)(e.data.map((function(e){return e.decade}))).sort();return{$schema:"https://vega.github.io/schema/vega-lite/v5.json",mark:{type:"area"},width:e.width,height:e.height,data:{values:e.data},encoding:{x:{field:"year",type:"quantitative",title:"Year",axis:{format:"d",values:Object(j.uniq)(t)},scale:{domain:[e.yearStart,e.yearEnd]}},y:{aggregate:"sum",field:"value",title:"Feature Dominance",stack:"normalize"},color:{field:"feature_name",type:"nominal",title:"Audio Feature"}}}}function S(e){if(!e.show)return Object(O.jsx)(g.a,{});var t=new y(e);return Object(O.jsx)(g.a,{children:Object(O.jsx)(b.a,{spec:A(Object(h.a)(Object(h.a)(Object(h.a)({},e),t),{},{data:e.dataset.toFeaturesVisRow(t)}))})})}function T(e){return{$schema:"https://vega.github.io/schema/vega/v5.json",description:"A radar chart example, showing multiple dimensions in a radial layout.",width:e.width,height:e.height,padding:e.padding,autosize:{type:"none",contains:"padding"},signals:[{name:"radius",update:"width / 2"}],data:[{name:"table",values:e.data},{name:"keys",source:"table",transform:[{type:"aggregate",groupby:["key"]}]}],scales:[{name:"angular",type:"point",range:{signal:"[-PI,PI]"},padding:.5,domain:{data:"table",field:"key"}},{name:"radial",type:"linear",range:{signal:"[0, radius]"},zero:!0,nice:!1,domain:{data:"table",field:"value"},domainMin:0},{name:"color",type:"ordinal",domain:{data:"table",field:"category"},range:{scheme:"category10"}}],encode:{enter:{x:{signal:"radius"},y:{signal:"radius"}}},marks:[{type:"group",name:"categories",zindex:1,from:{facet:{data:"table",name:"facet",groupby:["category"]}},marks:[{type:"line",name:"category-line",from:{data:"facet"},encode:{enter:{interpolate:{value:"linear-closed"},x:{signal:"scale('radial', datum.value) * cos(scale('angular', datum.key))"},y:{signal:"scale('radial', datum.value) * sin(scale('angular', datum.key))"},stroke:{scale:"color",field:"category"},strokeWidth:{value:1},fill:{scale:"color",field:"category"},fillOpacity:{value:.1}}}},{type:"text",name:"value-text",from:{data:"category-line"},encode:{enter:{x:{signal:"datum.x"},y:{signal:"datum.y"},text:{signal:"datum.datum.value"},align:{value:"center"},baseline:{value:"middle"},fill:{value:"black"}}}}]},{type:"rule",name:"radial-grid",from:{data:"keys"},zindex:0,encode:{enter:{x:{value:0},y:{value:0},x2:{signal:"radius * cos(scale('angular', datum.key))"},y2:{signal:"radius * sin(scale('angular', datum.key))"},stroke:{value:"lightgray"},strokeWidth:{value:1}}}},{type:"text",name:"key-label",from:{data:"keys"},zindex:1,encode:{enter:{x:{signal:"(radius + 5) * cos(scale('angular', datum.key))"},y:{signal:"(radius + 5) * sin(scale('angular', datum.key))"},text:{field:"key"},align:[{test:"abs(scale('angular', datum.key)) > PI / 2",value:"right"},{value:"left"}],baseline:[{test:"scale('angular', datum.key) > 0",value:"top"},{test:"scale('angular', datum.key) == 0",value:"middle"},{value:"bottom"}],fill:{value:"black"},fontWeight:{value:"bold"}}}},{type:"line",name:"outer-line",from:{data:"radial-grid"},encode:{enter:{interpolate:{value:"linear-closed"},x:{field:"x2"},y:{field:"y2"},stroke:{value:"lightgray"},strokeWidth:{value:1}}}}]}}function _(e){if(!e.show)return Object(O.jsx)(g.a,{});var t=new y(e),a=e.dataset.toFeaturesVisRow(t).map((function(e){return{key:e.feature_name,category:e.decade,value:e.value}})),n=f.c(a,(function(e){return e.category}),(function(e){return e.key})).map((function(e){var t=Object(c.a)(e,3);return{category:t[0],key:t[1],value:t[2].reduce((function(e,t){return e+t.value}),0)}})),r=Object(j.uniq)(n.map((function(e){return e.category}))).sort();return Object(O.jsx)(g.a,{children:Object(O.jsx)(u.a,{container:!0,children:r.map((function(t){return Object(O.jsxs)(u.a,{item:!0,md:6,children:[Object(O.jsx)("h3",{children:t}),Object(O.jsx)(b.a,{spec:T(Object(h.a)(Object(h.a)({},e),{},{data:n.filter((function(e){return t===e.category}))}))})]},t)}))})})}var E=a(8),C=a(10),q=a(11),z=a(48),M=a(397),R=a(393),V=function(e){Object(C.a)(a,e);var t=Object(q.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(E.a)(a,[{key:"selected",value:function(e){var t;return null!==(t=this.get(e))&&void 0!==t&&t}},{key:"selectedGenres",value:function(){var e=this;return Array.from(this.keys()).filter((function(t){return e.selected(t)}))}}]),a}(Object(z.a)(Map));function F(e){function t(t){return Object(O.jsx)(l.a,{value:e.genreToggles.get(t),onChange:function(a){var n=new V(e.genreToggles);n.set(t,a.target.checked),e.setGenreToggles(n)}})}return Object(O.jsx)(M.a,{children:e.options.map((function(e){return Object(O.jsx)(R.a,{control:t(e),label:e},e)}))})}var N=a.p+"static/media/spotify_decades.d5ba62b9.csv",G=function(){function e(t){for(var a in Object(m.a)(this,e),this.name="",this.artist="",this.album_name="",this.album_image_url="",this.album_release_date="",this.duration_ms="",this.explicit="",this.popularity="",this.preview_url="",this.danceability="",this.energy="",this.key="",this.loudness="",this.mode="",this.speechiness="",this.acousticness="",this.instrumentalness="",this.liveness="",this.valence="",this.tempo="",this.time_signature="",this.artist_followers="",this.artist_genres="",this.artist_popularity="",this.track_id="",t){var n;this[a]=null!==(n=t[a])&&void 0!==n?n:""}}return Object(E.a)(e,[{key:"year",value:function(){return Number(this.album_release_date.slice(0,4))}},{key:"decade",value:function(){return this.year()-this.year()%10}},{key:"genres",value:function(){return this.artist_genres.replaceAll(/[[\]'"]/gi,"").split(",").map((function(e){return e.trim()})).filter((function(e){return e.length>0}))}}]),e}();var B=["danceability","energy","speechiness","acousticness","instrumentalness","liveness","valence"],I=function(){function e(t){var a=this;Object(m.a)(this,e),this.rows=void 0,this.genres=void 0,this.genreCounts=void 0,this.rows=t;var n=t.flatMap((function(e){return e.genres()}));this.genreCounts=n.reduce((function(e,t){var a;return e.set(t,1+(null!==(a=e.get(t))&&void 0!==a?a:0))}),new Map),this.genres=Object(j.uniq)(n).sort((function(e,t){var n,r,i=null!==(n=a.genreCounts.get(e))&&void 0!==n?n:0,s=null!==(r=a.genreCounts.get(t))&&void 0!==r?r:0;return i===s?e.localeCompare(t):i-s}))}return Object(E.a)(e,[{key:"toArtistsVisRow",value:function(e){var t=e.genreToggles.selectedGenres(),a=this.rows.filter((function(t){return t.year()>=e.yearStart})).filter((function(t){return t.year()<=e.yearEnd})).filter((function(e){return Object(j.isEmpty)(t)||Object(j.intersection)(t,e.genres()).length>0})).filter((function(e){return e.decade()>0})).map((function(e){return{artist:e.artist,year:e.year(),decade:e.decade(),genres:e.genres()}})),n=f.d(a,(function(e){return e.decade}),(function(e){return e.artist}));return Array.from(n).flatMap((function(e){var t=Object(c.a)(e,2),a=t[0],n=t[1],r=Array.from(n).map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return{decade:a,artist:n,count:r.length,distinctArtists:1,genres:r.flatMap((function(e){return e.genres}))}}));return r.push({decade:a,artist:"",count:r.reduce((function(e,t){return e+t.count}),0),distinctArtists:r.length,genres:r.flatMap((function(e){return e.genres}))}),r}))}},{key:"toFeaturesVisRow",value:function(e){var t=e.genreToggles.selectedGenres();return this.rows.filter((function(t){return t.year()>=e.yearStart})).filter((function(t){return t.year()<=e.yearEnd})).filter((function(e){return Object(j.isEmpty)(t)||Object(j.intersection)(t,e.genres()).length>0})).flatMap((function(e){return B.map((function(t){return{year:e.year(),decade:e.decade(),feature_name:t,value:e[t]?Number(e[t]):0,genres:e.genres()}}))}))}}],[{key:"fromBlob",value:function(t){return new e(f.b(t).map((function(e){return new G(e)})))}}]),e}(),D=a(391);function W(e){var t=Object(n.useState)(""),a=Object(c.a)(t,2),r=a[0],i=a[1],s=e.options.filter((function(e){return e&&e.toLowerCase().includes(r)})).slice(0,10),o=Object(j.uniq)([].concat(Object(d.a)(s),Object(d.a)(e.selected)));return Object(O.jsxs)(u.a,{container:!0,children:[Object(O.jsx)(u.a,{item:!0,xs:12,children:Object(O.jsx)(D.a,{label:"search genres",variant:"standard",onChange:function(e){return i(e.target.value)}})}),Object(O.jsxs)(u.a,{item:!0,xs:12,children:[Object(O.jsx)("h4",{children:"Top matches"}),Object(O.jsx)(F,{genreToggles:e.genreToggles,setGenreToggles:e.setGenreToggles,options:o})]})]})}var $=Object(O.jsx)("p",{children:"Loading..."});var J=function(){var e=function(){var e=Object(n.useState)(sessionStorage.getItem("dataBytes")),t=Object(c.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){var e;(null!==(e=null===a||void 0===a?void 0:a.length)&&void 0!==e?e:0)>0||fetch(N).then((function(e){return e.text()})).then((function(e){e&&(r(e),sessionStorage.setItem("dataBytes",e))}))})),a}(),t=Object(n.useState)(new V),a=Object(c.a)(t,2),r=a[0],i=a[1],s=Object(n.useState)(!0),d=Object(c.a)(s,2),h=d[0],g=d[1],f=Object(n.useState)(!1),j=Object(c.a)(f,2),b=j[0],m=j[1],y=Object(n.useState)(!1),v=Object(c.a)(y,2),p=v[0],w=v[1],A=Object(n.useState)(!1),T=Object(c.a)(A,2),E=T[0],C=T[1];if(!e)return $;var q=I.fromBlob(e),z=q.genres.reverse(),M=Array.from(r.keys()).filter((function(e){return r.get(e)}));return Object(O.jsx)(n.Suspense,{fallback:$,children:Object(O.jsx)(o.a,{children:Object(O.jsxs)(u.a,{container:!0,children:[Object(O.jsxs)(u.a,{item:!0,xs:12,style:{textAlign:"center"},children:[Object(O.jsx)("h1",{children:"Visualizing Audio Features over the Decades"}),Object(O.jsx)("em",{children:"Created by Jackson Argo, Matt Kinley, and Erick Martinez."})]}),Object(O.jsx)(u.a,{item:!0,xs:2,children:Object(O.jsx)(W,{genreToggles:r,setGenreToggles:i,options:z,selected:M})}),Object(O.jsxs)(u.a,{item:!0,xs:10,children:[Object(O.jsx)("h2",{children:"Variation in Features"}),Object(O.jsx)(l.a,{checked:h,onChange:function(e){g(e.target.checked)}}),Object(O.jsx)(S,{show:h,dataset:q,genreToggles:r,height:300,width:800}),Object(O.jsx)("h2",{children:"Variation in Features Radar"}),Object(O.jsx)(l.a,{checked:b,onChange:function(e){m(e.target.checked)}}),Object(O.jsx)(_,{show:b,dataset:q,genreToggles:r,height:400,width:400,padding:40}),Object(O.jsx)("h2",{children:"Count of Top Artists"}),Object(O.jsx)(l.a,{checked:p,onChange:function(e){w(e.target.checked)}}),Object(O.jsx)(k,{show:p,dataset:q,genreToggles:r,height:300,width:800,margin:{left:50,top:50,right:20,bottom:20}}),Object(O.jsx)("h2",{children:"Top Artists by Decade"}),Object(O.jsx)(l.a,{checked:E,onChange:function(e){C(e.target.checked)}}),Object(O.jsx)(x,{show:E,dataset:q,genreToggles:r,topN:10,height:300,width:800})]})]})})})};s.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(J,{})}),document.getElementById("root"))}},[[334,1,2]]]);
//# sourceMappingURL=main.f139dacc.chunk.js.map